---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import Footer from "../../components/Footer.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import Header from "../../components/Header.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    <style>
      main {
        max-width: 1200px;
        margin: 0 auto;
        padding: 4rem 2rem;
      }

      .blog-header {
        text-align: center;
        margin-bottom: 4rem;
      }

      .blog-header h1 {
        font-family: var(--font-heading);
        font-size: var(--text-5xl);
        color: var(--accent-secondary);
        margin-bottom: 1rem;
        font-weight: 700;
        letter-spacing: -0.02em;
      }

      .blog-header p {
        font-family: var(--font-body);
        font-size: var(--text-xl);
        color: rgb(var(--gray));
        max-width: 600px;
        margin: 0 auto;
        line-height: 1.5;
      }

      .posts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2.5rem;
        padding: 0;
        list-style: none;
      }

      .post-card {
        background: var(--background);
        border-radius: 12px;
        overflow: hidden;
        transition:
          transform 0.3s ease,
          box-shadow 0.3s ease;
      }

      .post-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--box-shadow);
      }

      .post-card a {
        text-decoration: none;
        color: inherit;
      }

      .post-card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 12px 12px 0 0;
      }

      .post-content {
        padding: 1.5rem;
      }

      .post-card .title {
        font-family: var(--font-heading);
        font-size: var(--text-xl);
        color: rgb(var(--black));
        margin: 0 0 0.5rem 0;
        line-height: 1.3;
        font-weight: 600;
      }

      .post-card .date {
        font-family: var(--font-body);
        font-size: var(--text-sm);
        color: rgb(var(--gray));
        margin: 0;
      }

      .featured-post {
        grid-column: 1 / -1;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        align-items: center;
        margin-bottom: 2rem;
      }

      .featured-post img {
        height: 400px;
        object-fit: cover;
        border-radius: 12px;
      }

      .featured-post .post-content {
        padding: 2rem;
      }

      .featured-post .title {
        font-size: var(--text-4xl);
        margin-bottom: 1rem;
      }

      @media (max-width: 768px) {
        .featured-post {
          grid-template-columns: 1fr;
        }

        .featured-post img {
          height: 300px;
        }

        .blog-header h1 {
          font-size: var(--text-4xl);
        }

        .blog-header p {
          font-size: var(--text-lg);
        }

        /* Add these new rules */
        .featured-post .title {
          font-size: var(--text-2xl);
        }

        .post-card .title {
          font-size: var(--text-lg);
        }

        .posts-grid {
          grid-template-columns: 1fr;
          gap: 1.5rem;
        }

        main {
          padding: 2rem 1rem;
        }
      }
    </style>
  </head>
  <body>
    <Header />
    <main>
      <div class="blog-header">
        <h1>Insights & Updates</h1>
        <p>
          Exploring bioinformatics, data analysis, and the latest developments in genomic research.
        </p>
      </div>
      <ul class="posts-grid">
        {
          posts.map((post, index) => (
            <li class={index === 0 ? "featured-post" : "post-card"}>
              <a href={`/blog/${post.id}/`}>
                {post.data.heroImage && (
                  <Image
                    width={index === 0 ? 800 : 400}
                    height={index === 0 ? 400 : 200}
                    src={post.data.heroImage}
                    alt=""
                  />
                )}
                <div class="post-content">
                  <h2 class="title">{post.data.title}</h2>
                  <p class="date">
                    <FormattedDate date={post.data.pubDate} />
                  </p>
                </div>
              </a>
            </li>
          ))
        }
      </ul>
    </main>
    <Footer />
  </body>
</html>
